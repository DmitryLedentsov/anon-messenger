# Анонимный Мессенджер AnonMessenger

## Deploy docker-compose

```bash
# Build application
cd messenger
# Put jar file into ${project_dir}/docker-files
sudo mvn -с install
cd ../docker-files
# Remove old images
sudo docker-compose --env-file ./default.env down
sudo docker image rm -f $(sudo docker image ls -q)

# Build new (without caching, cache doesn't update after not Dockerfile changes)
sudo docker-compose --env-file ./default.env build --no-cache

# Start postgres, messenger at http://localhost:9087 and zabbix at http://localhost:8080
sudo docker-compose --env-file ./default.env up postgres_db messenger monitoring_server -d 
```

Если вы хотите запустить сервер на определённом IP-адресе, то надо отредактировать файл *application-net.properties*, где указываете вместо localhost нужный вам IP-адрес:

```text
messenger.public-url = http://localhost:9087
messenger.websocket.url = ws://localhost:9087/ws
```

Собрать и запустить как раньше, но с указанием другого docker-compose конфигурационного файла:

```bash
sudo docker-compose --env-file ./default.env -f ./docker-compose-net.yml build --no-cache

sudo docker-compose --env-file ./default.env -f ./docker-compose-net.yml up postgres_db messenger monitoring_server -d 
```

## Описание предметной области

Анонимный мессенджер с минимальными данными о пользователе - не хранится никакой личной информации, только логин/пароль. Для пользования мессенджером пользователь регистрируется или заходит под уже созданным аккаунтом.

Для входа нужны:

* Логин
* Пароль

Для регистрации нужны:

* Уникальный никнейм (логин)
* Пароль

После аутентификации и авторизации пользователь имеет следующие возможности:

* Создавать собственные чаты
* Приглашать в свои чаты людей (по логину)
* Писать и просматривать текстовые сообщения
* Банить пользователей в чате (если есть роль админа или создателя чата)
* Создатель чата может назначать админами других пользователей
* Удалять свои чаты вместе со всеми сообщениями
* Удаление аккаунта
* Выход из аккаунта

## Описание бизнес процессов

При входе на сайт пользователю отображается страница для аутентификации и авторизации с полями “Логин” и “Пароль”, а также кнопками “Войти” и “Регистрация”.
Для входа в аккаунт, пользователю нужно будет ввести никнейм (логин) и пароль, а потом нажать “Войти” - данные пройдут валидацию и отправятся на сервер для проверки на наличие таких пользователей в БД.

Если пользователь захочет создать новый аккаунт - ему нужно будет нажать на кнопку “Регистрация”, которая перекинет на страницу для регистрации, ввести уникальный логин (которого ещё не существует), пароль и нажать на кнопку “Зарегистрироваться” - данные провалидируются и отправятся на сервер, где будут проверены (уникальность логина и server-side валидация пароля).

После аутентификации и авторизации пользователя перекинет на основную страницу с списком чатов. Здесь пользователь сможет:

* Создать новый чат
* Читать сообщения в уже существующих чатах
* Удалять чаты
* Выйти из аккаунта
* Удалить аккаунт

При нажатии на чат будут загружаться данные о чате и сообщения пользователей.
В чате пользователь сможет:

* Удалять пользователей (если создатель)
* Просматривать сообщения
* Удалить текущий чат(все свои сообщения)

При создании чата будет отображаться соответствующее окно с следующими полями:

* Название чата (Не обязательно уникальное)
* Список людей, которых пользователь собирается пригласить
* Строка поиска, для поиска людей по никнейму

## Стек технологий

Backend: Spring+PostgreSQL

Frontend: Js(Jquery) + Websockets

## Этапы рефакторинга

* Внедрение шифрования по алгоритму ГОСТ
* Переделать под SPA(все на одной странице)
* Минимизировать и нормализовать базу данных
